<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Coupling: coupling.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Coupling
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('coupling_8cpp.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">coupling.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;vector&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;array&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cstddef&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-namespaces" class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:steel" id="r_steel"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesteel.html">steel</a></td></tr>
<tr class="memdesc:namespacesteel"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides material properties for steel. <br /></td></tr>
<tr class="memitem:liquid_5Fsodium" id="r_liquid_5Fsodium"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html">liquid_sodium</a></td></tr>
<tr class="memdesc:namespaceliquid__sodium"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides thermophysical properties for Liquid Sodium (Na). <br /></td></tr>
<tr class="memitem:vapor_5Fsodium" id="r_vapor_5Fsodium"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html">vapor_sodium</a></td></tr>
<tr class="memdesc:namespacevapor__sodium"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides thermophysical and transport properties for Sodium Vapor. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a48fc450adecaed9dfff6df33f2383398" id="r_a48fc450adecaed9dfff6df33f2383398"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a> = std::array&lt;double, 6&gt;</td></tr>
<tr class="memitem:aacd8426c8e13284c47795ca7fef1dc2f" id="r_aacd8426c8e13284c47795ca7fef1dc2f"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aacd8426c8e13284c47795ca7fef1dc2f">Mat6x6</a> = std::array&lt;std::array&lt;double, 6&gt;, 6&gt;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1e6f61bc8754f43f2fe40bc46077dde8" id="r_a1e6f61bc8754f43f2fe40bc46077dde8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesteel.html#a1e6f61bc8754f43f2fe40bc46077dde8">steel::cp</a> (double Tquery)</td></tr>
<tr class="memdesc:a1e6f61bc8754f43f2fe40bc46077dde8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific heat interpolation in temperature with complexity O(1).  <br /></td></tr>
<tr class="memitem:a100535174f861de26e846e06abc41320" id="r_a100535174f861de26e846e06abc41320"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesteel.html#a100535174f861de26e846e06abc41320">steel::rho</a> (double <a class="el" href="namespacesteel.html#a431acf12e3bac3e5cd72b5fc493b9e84">T</a>)</td></tr>
<tr class="memdesc:a100535174f861de26e846e06abc41320"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density [kg/m3] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a4e215f6487ce12b727aee359f8968d25" id="r_a4e215f6487ce12b727aee359f8968d25"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesteel.html#a4e215f6487ce12b727aee359f8968d25">steel::k</a> (double <a class="el" href="namespacesteel.html#a431acf12e3bac3e5cd72b5fc493b9e84">T</a>)</td></tr>
<tr class="memdesc:a4e215f6487ce12b727aee359f8968d25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thermal conductivity [W/(m*K)] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a623b627263d260ad9ff8a8d8b7c18538" id="r_a623b627263d260ad9ff8a8d8b7c18538"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html#a623b627263d260ad9ff8a8d8b7c18538">liquid_sodium::rho</a> (double T)</td></tr>
<tr class="memdesc:a623b627263d260ad9ff8a8d8b7c18538"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density [kg/m3] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a8d51a3e555a4f02ab073f863d5f4d392" id="r_a8d51a3e555a4f02ab073f863d5f4d392"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html#a8d51a3e555a4f02ab073f863d5f4d392">liquid_sodium::k</a> (double T)</td></tr>
<tr class="memdesc:a8d51a3e555a4f02ab073f863d5f4d392"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thermal conductivity [W/(m*K)] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a9cddf40b7e023fbbe7da8897f8ee803d" id="r_a9cddf40b7e023fbbe7da8897f8ee803d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html#a9cddf40b7e023fbbe7da8897f8ee803d">liquid_sodium::cp</a> (double T)</td></tr>
<tr class="memdesc:a9cddf40b7e023fbbe7da8897f8ee803d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific heat at constant pressure [J/(kg·K)] as a function of temperature.  <br /></td></tr>
<tr class="memitem:a486c58618892900fa0602ee46c00254e" id="r_a486c58618892900fa0602ee46c00254e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html#a486c58618892900fa0602ee46c00254e">liquid_sodium::mu</a> (double T)</td></tr>
<tr class="memdesc:a486c58618892900fa0602ee46c00254e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic viscosity [Pa·s] using Shpilrain et al. correlation, valid for 371 K &lt; T &lt; 2500 K.  <br /></td></tr>
<tr class="memitem:a27d99137e0d8e08ad695b2a560bda1e8" id="r_a27d99137e0d8e08ad695b2a560bda1e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a27d99137e0d8e08ad695b2a560bda1e8">vapor_sodium::clamp</a> (double x, double a, double b)</td></tr>
<tr class="memdesc:a27d99137e0d8e08ad695b2a560bda1e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions that clamps a value x to the range [a, b].  <br /></td></tr>
<tr class="memitem:ad5235477b202416e683b748ef18c176f" id="r_ad5235477b202416e683b748ef18c176f"><td class="memTemplParams" colspan="2">template&lt;size_t N&gt; </td></tr>
<tr class="memitem:ad5235477b202416e683b748ef18c176f template"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#ad5235477b202416e683b748ef18c176f">vapor_sodium::interp_T</a> (const std::array&lt; double, N &gt; &amp;Tgrid, const std::array&lt; double, N &gt; &amp;Ygrid, double T)</td></tr>
<tr class="memdesc:ad5235477b202416e683b748ef18c176f"><td class="mdescLeft">&#160;</td><td class="mdescRight">1D table interpolation in T over monotone grid  <br /></td></tr>
<tr class="memitem:a173d241ce6cdd47597b858f1b358a34f" id="r_a173d241ce6cdd47597b858f1b358a34f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a173d241ce6cdd47597b858f1b358a34f">vapor_sodium::h_vap</a> (double T)</td></tr>
<tr class="memdesc:a173d241ce6cdd47597b858f1b358a34f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enthalpy of vaporization [J/kg] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a123d26c84c9262c7c5930857be3b0325" id="r_a123d26c84c9262c7c5930857be3b0325"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a123d26c84c9262c7c5930857be3b0325">vapor_sodium::P_sat</a> (double T)</td></tr>
<tr class="memdesc:a123d26c84c9262c7c5930857be3b0325"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saturation pressure [Pa] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a780cdbaab3829932df754aaa2fe86e24" id="r_a780cdbaab3829932df754aaa2fe86e24"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a780cdbaab3829932df754aaa2fe86e24">vapor_sodium::dP_sat_dVT</a> (double T)</td></tr>
<tr class="memdesc:a780cdbaab3829932df754aaa2fe86e24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of saturation pressure with respect to temperature [Pa/K] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a3e796a456d7cbd1a285adc6e64c7381b" id="r_a3e796a456d7cbd1a285adc6e64c7381b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a3e796a456d7cbd1a285adc6e64c7381b">vapor_sodium::rho</a> (double T)</td></tr>
<tr class="memdesc:a3e796a456d7cbd1a285adc6e64c7381b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density of saturated vapor [kg/m^3] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a52b2291c7c02870eba64b28e6e028770" id="r_a52b2291c7c02870eba64b28e6e028770"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a52b2291c7c02870eba64b28e6e028770">vapor_sodium::cp</a> (double T)</td></tr>
<tr class="memdesc:a52b2291c7c02870eba64b28e6e028770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific heat at constant pressure from table interpolation [J/(kg*K)] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:af39f6a7b3c685bfc32f69ee0ed79800f" id="r_af39f6a7b3c685bfc32f69ee0ed79800f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#af39f6a7b3c685bfc32f69ee0ed79800f">vapor_sodium::cv</a> (double T)</td></tr>
<tr class="memdesc:af39f6a7b3c685bfc32f69ee0ed79800f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific heat at constant volume from table interpolation [J/(kg*K)] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:ab0a521e6708d4c0c4a769bcb5abc0d9c" id="r_ab0a521e6708d4c0c4a769bcb5abc0d9c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#ab0a521e6708d4c0c4a769bcb5abc0d9c">vapor_sodium::mu</a> (double T)</td></tr>
<tr class="memdesc:ab0a521e6708d4c0c4a769bcb5abc0d9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic viscosity of sodium vapor [Pa·s] as a function of temperature T.  <br /></td></tr>
<tr class="memitem:a25c40b2d1c7425eeea393ed8e7d8b981" id="r_a25c40b2d1c7425eeea393ed8e7d8b981"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a25c40b2d1c7425eeea393ed8e7d8b981">vapor_sodium::k</a> (double T, double P)</td></tr>
<tr class="memdesc:a25c40b2d1c7425eeea393ed8e7d8b981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thermal conductivity [W/(m*K)] of sodium vapor over an extended range.  <br /></td></tr>
<tr class="memitem:aec4295853b40ba8be61d70e2135e8c4d" id="r_aec4295853b40ba8be61d70e2135e8c4d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#aec4295853b40ba8be61d70e2135e8c4d">vapor_sodium::f</a> (double Re)</td></tr>
<tr class="memdesc:aec4295853b40ba8be61d70e2135e8c4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Friction factor [-] (Gnielinski correlation) as a function of Reynolds number. Retrieves an error if Re &lt; 0.  <br /></td></tr>
<tr class="memitem:a346bf1ebc5a79a676e68f236ff9bb216" id="r_a346bf1ebc5a79a676e68f236ff9bb216"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a346bf1ebc5a79a676e68f236ff9bb216">vapor_sodium::Nu</a> (double Re, double Pr)</td></tr>
<tr class="memdesc:a346bf1ebc5a79a676e68f236ff9bb216"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nusselt number [-] (Gnielinski correlation) as a function of Reynolds number Retrieves an error if Re &lt; 0 or Nu &lt; 0.  <br /></td></tr>
<tr class="memitem:afea027e6e01ec1144bc022fc68ebc0d8" id="r_afea027e6e01ec1144bc022fc68ebc0d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#afea027e6e01ec1144bc022fc68ebc0d8">vapor_sodium::h_conv</a> (double Re, double Pr, double <a class="el" href="namespacevapor__sodium.html#a25c40b2d1c7425eeea393ed8e7d8b981">k</a>, double Dh)</td></tr>
<tr class="memdesc:afea027e6e01ec1144bc022fc68ebc0d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convective heat transfer coefficient [W/m^2/K] (Gnielinski correlation) as a function of Reynolds number Retrieves an error if Re &lt; 0 or Nu &lt; 0.  <br /></td></tr>
<tr class="memitem:a8d9a4315511d73aa1771dcc2f526c92e" id="r_a8d9a4315511d73aa1771dcc2f526c92e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d9a4315511d73aa1771dcc2f526c92e">solveTridiagonal</a> (const std::vector&lt; double &gt; &amp;a, const std::vector&lt; double &gt; &amp;b, const std::vector&lt; double &gt; &amp;c, const std::vector&lt; double &gt; &amp;d)</td></tr>
<tr class="memdesc:a8d9a4315511d73aa1771dcc2f526c92e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves a tridiagonal system of linear equations A*x = d using the Thomas Algorithm (TDMA).  <br /></td></tr>
<tr class="memitem:a2d93b590ec4558c784a21cc3ed1d965c" id="r_a2d93b590ec4558c784a21cc3ed1d965c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d93b590ec4558c784a21cc3ed1d965c">solve6</a> (<a class="el" href="#aacd8426c8e13284c47795ca7fef1dc2f">Mat6x6</a> A, <a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a> b)</td></tr>
<tr class="memdesc:a2d93b590ec4558c784a21cc3ed1d965c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves a 6x6 system of linear equations A*x = b using Gaussian elimination.  <br /></td></tr>
<tr class="memitem:a2c4ccc3b10ececc758cadccc3443bf9a" id="r_a2c4ccc3b10ececc758cadccc3443bf9a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c4ccc3b10ececc758cadccc3443bf9a">linspace</a> (double T_min, double T_max, int N)</td></tr>
<tr class="memdesc:a2c4ccc3b10ececc758cadccc3443bf9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate N linearly spaced values from T_min to T_max.  <br /></td></tr>
<tr class="memitem:aaa4b5e5c27faabf8d15f4b629847cb5a" id="r_aaa4b5e5c27faabf8d15f4b629847cb5a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa4b5e5c27faabf8d15f4b629847cb5a">new_dt_w</a> (double dz, double dt_old, const std::vector&lt; double &gt; &amp;T, const std::vector&lt; double &gt; &amp;St)</td></tr>
<tr class="memdesc:aaa4b5e5c27faabf8d15f4b629847cb5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute adaptive time step for the wall region based on Fourier and source limits.  <br /></td></tr>
<tr class="memitem:a4baec83d8b53f813e178e216e6bf564e" id="r_a4baec83d8b53f813e178e216e6bf564e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4baec83d8b53f813e178e216e6bf564e">new_dt_x</a> (double dz, double dt_old, const std::vector&lt; double &gt; &amp;u, const std::vector&lt; double &gt; &amp;T, const std::vector&lt; double &gt; &amp;Sm)</td></tr>
<tr class="memdesc:a4baec83d8b53f813e178e216e6bf564e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute adaptive time step for the wick region based on CFL and source limits.  <br /></td></tr>
<tr class="memitem:a8909682f224220a63ed73605d81d23b9" id="r_a8909682f224220a63ed73605d81d23b9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8909682f224220a63ed73605d81d23b9">new_dt_v</a> (double dz, double dt_old, const std::vector&lt; double &gt; &amp;u, const std::vector&lt; double &gt; &amp;T, const std::vector&lt; double &gt; &amp;rho, const std::vector&lt; double &gt; &amp;Sm, const std::vector&lt; double &gt; &amp;bVU)</td></tr>
<tr class="memdesc:a8909682f224220a63ed73605d81d23b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute adaptive time step for the vapor region from CFL, source, and pressure limits.  <br /></td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4" id="r_ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="memdesc:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simplified 1D transient coupling between wall, wick, and vapor.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a431acf12e3bac3e5cd72b5fc493b9e84" id="r_a431acf12e3bac3e5cd72b5fc493b9e84"><td class="memItemLeft" align="right" valign="top">constexpr std::array&lt; double, 15 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesteel.html#a431acf12e3bac3e5cd72b5fc493b9e84">steel::T</a> = { 300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700 }</td></tr>
<tr class="memdesc:a431acf12e3bac3e5cd72b5fc493b9e84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temperature values of the Cp table [K].  <br /></td></tr>
<tr class="memitem:a318072538d605f90edbe5ad16a182bf1" id="r_a318072538d605f90edbe5ad16a182bf1"><td class="memItemLeft" align="right" valign="top">constexpr std::array&lt; double, 15 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesteel.html#a318072538d605f90edbe5ad16a182bf1">steel::Cp_J_kgK</a> = { 510.0296,523.4184,536.8072,550.1960,564.0032,577.3920,590.7808,604.1696,617.5584,631.3656,644.7544,658.1432,671.5320,685.3392,698.7280 }</td></tr>
<tr class="memdesc:a318072538d605f90edbe5ad16a182bf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specific heat values of the Cp table [J kg^-1 K^-1].  <br /></td></tr>
<tr class="memitem:a65762b3f69a8a13edcb01fda6430449d" id="r_a65762b3f69a8a13edcb01fda6430449d"><td class="memItemLeft" align="right" valign="top">constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html#a65762b3f69a8a13edcb01fda6430449d">liquid_sodium::Tcrit</a> = 2509.46</td></tr>
<tr class="memdesc:a65762b3f69a8a13edcb01fda6430449d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Critical temperature [K].  <br /></td></tr>
<tr class="memitem:aab1908ce27479d6f5240a218fc354212" id="r_aab1908ce27479d6f5240a218fc354212"><td class="memItemLeft" align="right" valign="top">constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceliquid__sodium.html#aab1908ce27479d6f5240a218fc354212">liquid_sodium::Tsolid</a> = 370.87</td></tr>
<tr class="memdesc:aab1908ce27479d6f5240a218fc354212"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solidification temperature [K].  <br /></td></tr>
<tr class="memitem:af948cf9194768978a66b5199bc04bcbe" id="r_af948cf9194768978a66b5199bc04bcbe"><td class="memItemLeft" align="right" valign="top">constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#af948cf9194768978a66b5199bc04bcbe">vapor_sodium::Tcrit_Na</a> = 2509.46</td></tr>
<tr class="memdesc:af948cf9194768978a66b5199bc04bcbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Critical temperature [K].  <br /></td></tr>
<tr class="memitem:ab35804cf2891f81d43400bfc0f0e67f7" id="r_ab35804cf2891f81d43400bfc0f0e67f7"><td class="memItemLeft" align="right" valign="top">constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#ab35804cf2891f81d43400bfc0f0e67f7">vapor_sodium::Ad_Na</a> = 3.46</td></tr>
<tr class="memdesc:ab35804cf2891f81d43400bfc0f0e67f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adiabatic factor [-].  <br /></td></tr>
<tr class="memitem:a2e2a2eeb251dbbbe64ce9b29398085ed" id="r_a2e2a2eeb251dbbbe64ce9b29398085ed"><td class="memItemLeft" align="right" valign="top">constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacevapor__sodium.html#a2e2a2eeb251dbbbe64ce9b29398085ed">vapor_sodium::m_g_Na</a> = 23e-3</td></tr>
<tr class="memdesc:a2e2a2eeb251dbbbe64ce9b29398085ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molar mass [kg/mol].  <br /></td></tr>
</table>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="aacd8426c8e13284c47795ca7fef1dc2f" name="aacd8426c8e13284c47795ca7fef1dc2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacd8426c8e13284c47795ca7fef1dc2f">&#9670;&#160;</a></span>Mat6x6</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#aacd8426c8e13284c47795ca7fef1dc2f">Mat6x6</a> = std::array&lt;std::array&lt;double, 6&gt;, 6&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a48fc450adecaed9dfff6df33f2383398" name="a48fc450adecaed9dfff6df33f2383398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48fc450adecaed9dfff6df33f2383398">&#9670;&#160;</a></span>Vec6</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a> = std::array&lt;double, 6&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a2c4ccc3b10ececc758cadccc3443bf9a" name="a2c4ccc3b10ececc758cadccc3443bf9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4ccc3b10ececc758cadccc3443bf9a">&#9670;&#160;</a></span>linspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; linspace </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>T_min</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>T_max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>N</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate N linearly spaced values from T_min to T_max. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">T_min</td><td>start value. </td></tr>
    <tr><td class="paramname">T_max</td><td>end value. </td></tr>
    <tr><td class="paramname">N</td><td>number of points. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of uniformly spaced values. </dd></dl>

</div>
</div>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simplified 1D transient coupling between wall, wick, and vapor. </p>
<p>Entry point for the solver performing sequential time-integration of the solid wall, porous wick, and vapor core. </p>
<p>&lt; Wall emissivity [-]</p>
<p>&lt; Stefan-Boltzmann constant [W/m^2/K^4]</p>
<p>&lt; Gas constant for the sodium vapor [J/(kg K)]</p>
<p>&lt; Prandtl turbulent number for sodium vapor [-]</p>
<p>&lt; TODO: MAKE THIS PROPERTY TEMPERATURE DEPENDENT Ratio between constant pressure specific heat and constant volume specific heat [-]</p>
<p>&lt; Convective heat transfer coefficient for external heat removal [W/m^2/K]</p>
<p>&lt; Power at the evaporator side [W]</p>
<p>&lt; External environmental temperature [K]</p>
<p>&lt; Number of axial nodes [-]</p>
<p>&lt; Length of the heat pipe [m]</p>
<p>&lt; Axial discretization step [m]</p>
<p>&lt; Evaporator length [m]</p>
<p>&lt; Adiabatic length [m]</p>
<p>&lt; Condenser length [m]</p>
<p>&lt; Number of evaporator nodes</p>
<p>&lt; Number of condenser nodes</p>
<p>&lt; Number of adiabatic nodes</p>
<p>&lt; Outer wall radius [m]</p>
<p>&lt; Wall-wick interface radius [m]</p>
<p>&lt; Vapor-wick interface radius [m]</p>
<p>&lt; Wall radial area (at r_outer) [m^2]</p>
<p>&lt; Wall cross-sectional area [m^2]</p>
<p>&lt; Wick radial area (at r_interface) [m^2]</p>
<p>&lt; Wick cross-sectional area [m^2]</p>
<p>&lt; Vapor radial area (at r_inner) [m^2]</p>
<p>&lt; Vapor cross-sectional area [m^2]</p>
<p>&lt; Initial time step [s] (then it is updated according to the limits)</p>
<p>&lt; Number of timesteps</p>
<p>&lt; Total simulation time [s]</p>
<p>&lt; Permeability [m^2]</p>
<p>&lt; Forchheimer coefficient [1/m]</p>
<p>&lt; Outer iterations per time-step [-]</p>
<p>&lt; Inner iterations per outer iteration [-]</p>
<p>&lt; Tolerance for the inner iterations [-]</p>
<p>&lt; Tolerance for the inner iterations [-]</p>
<p>&lt; Outer iterations per time-step [-]</p>
<p>&lt; Inner iterations per outer iteration [-]</p>
<p>&lt; Tolerance for the inner iterations [-]</p>
<p>&lt; Tolerance for the inner iterations [-]</p>
<p>&lt; Number of nodes of the evaporator region [-]</p>
<p>&lt; Number of nodes of the condenser region [-]</p>
<p>&lt; Number of nodes of the adiabadic region [-]</p>
<p>&lt; Extremes for the outer wall initial temperature [K]</p>
<p>&lt; Extremes for the wall bulk initial temperature [K]</p>
<p>&lt; Extremes for the wall wick interface initial temperature [K]</p>
<p>&lt; Extremes for the wick bulk initial temperature [K]</p>
<p>&lt; Extremes for the wick vapor initial temperature [K]</p>
<p>&lt; Extremes for the vapor bulk initial temperature [K]</p>
<p>&lt; Wick velocity field [m/s]</p>
<p>&lt; Wick pressure field [Pa]</p>
<p>&lt; Wick correction pressure field [Pa]</p>
<p>&lt; Wick old pressure field [Pa]</p>
<p>&lt; Wick padded pressure vector for R&amp;C correction [Pa]</p>
<p>&lt; Poìnter to work on the wick pressure padded storage with the same indes</p>
<p>&lt; Vapor velocity field [m/s]</p>
<p>&lt; Vapor pressure field [Pa]</p>
<p>&lt; Vapor density field [Pa]</p>
<p>&lt; Vapor correction pressure field [Pa]</p>
<p>&lt; Vapor old pressure field [Pa]</p>
<p>&lt; Vapor old density field [Pa]</p>
<p>&lt; Vapor old velocity field [Pa]</p>
<p>&lt; Vapor padded pressure vector for R&amp;C correction [Pa]</p>
<p>&lt; Poìnter to work on the storage with the same indes</p>
<p>&lt; Wick inlet velocity [m/s]</p>
<p>&lt; Wick outlet velocity [m/s]</p>
<p>&lt; Wick outlet pressure [Pa]</p>
<p>&lt; Vapor inlet velocity [m/s]</p>
<p>&lt; Vapor outlet velocity [m/s]</p>
<p>&lt; Vapor outlet pressure [Pa]</p>
<p>&lt; Turbulence intensity [-]</p>
<p>&lt; Turbulence length scale [m]</p>
<p>&lt; Initial turbulent kinetic energy [m^2/s^2]</p>
<p>&lt; Initial specific dissipation rate [1/s]</p>
<p>&lt; k-equation turbulent Prandtl number [-]</p>
<p>&lt; ω-equation turbulent Prandtl number [-]</p>
<p>&lt; β* constant for SST model [-]</p>
<p>&lt; β constant for turbulence model [-]</p>
<p>&lt; α blending coefficient for SST model [-]</p>
<p>Vapor Equation of State update function. Updates density</p>
<p>&lt; Mass transfer parameters</p>
<p>&lt; Old mass transfer parameters</p>
<p>&lt; Heat flux at evaporator from given power [W/m^2]</p>
<p>&lt; Heat flux [W/m^2] across outer wall in wall region (positive if directed to wall)</p>
<p>&lt; Heat flux [W/m^2] across wall-wick interface in the wall region (positive if directed to wick)</p>
<p>&lt; Heat flux [W/m^2] across wall-wick interface in the wick region (positive if directed to wick)</p>
<p>&lt; Heat flux [W/m^2] across wick-vapor interface in the wick region (positive if directed to vapor)</p>
<p>&lt; Heat flux [W/m^2] across wick-vapor interface in the vapor region (positive if directed to vapor)</p>
<p>&lt; Wall heat source [W / m^3]</p>
<p>&lt; Wick heat source [W / m^3]</p>
<p>&lt; Vapor heat source [W / m^3]</p>
<p>&lt; 0: no wick RC correction, 1: wick with RC correction</p>
<p>&lt; 0: no vapor RC correction, 1: vapor with RC correction</p>
<p>&lt; 0: no vapor turbulence, 1: vapor with turbulence</p>
<p>&lt; Volumetric mass source [kg / (m^3 s)] (positive if evaporation)</p>
<p>&lt; Mass flux [kg/m2/s] at the wick-vapor interface (positive if evaporation)</p>
<p>The coefficient bU is needed in momentum predictor loop and pressure correction to estimate the velocities at the faces using the Rhie and Chow correction</p>
<p>&lt; Lower tridiagonal coefficient for wick velocity</p>
<p>&lt; Central tridiagonal coefficient for wick velocity</p>
<p>&lt; Upper tridiagonal coefficient for wick velocity</p>
<p>&lt; Known vector coefficient for wick velocity</p>
<p>The coefficient bVU is needed in momentum predictor loop and pressure correction to estimate the velocities aVT the faces using the Rhie and Chow correction</p>
<p>&lt; Lower tridiagonal coefficient for vapor velocity</p>
<p>&lt; Central tridiagonal coefficient for vapor velocity</p>
<p>&lt; Upper tridiagonal coefficient for vapor velocity</p>
<p>&lt; Known vector for vapor velocity</p>
<p>Print number of working threads</p>
<p>Time-stepping loop. The timestep is calculated at the beginning of each loop.</p>
<p>&lt; Lower tridiagonal coefficient for wall temperature</p>
<p>&lt; Central tridiagonal coefficient for wall temperature</p>
<p>&lt; Upper tridiagonal coefficient for wall temperature</p>
<p>&lt; Known vector coefficient for wall temperature</p>
<p>BCs for the first node: zero gradient, adiabatic face</p>
<p>BCs for the last node: zero gradient, adiabatic face</p>
<p>Loop on nodes. Assembles the coefficients for the tridiagonal system of wall temperature</p>
<p>Physical properties of the i-th wall node</p>
<p>Useful constant</p>
<p>Volumetric heat source in the wall due to heat flux at the outer wall [W/m^3]</p>
<p>Volumetric heat source in the wall due to heat flux at the wall-wick interface [W/m^3]</p>
<p>&lt; Wall volumetric heat source [W/m^3]</p>
<p>&lt; Vector of final wall bulk temperatures</p>
<p>Evaluates maximum absolute value of the wick velocity</p>
<p>Evaluates minimum value of the wick temperature</p>
<p>Pressure coupling hypotheses: the meniscus in the last cell of the domain is considered flat, so the pressure of the wick is equal to the pressure of the vapor</p>
<p>Outer iterations variables reset</p>
<p>Inner iterations variables initialization</p>
<p>Outer iterations. Stop when maximum number of iterations or velocity stops updating.</p>
<p>&lt; Density of the central cell</p>
<p>&lt; Density of the left cell</p>
<p>&lt; Density of the right cell</p>
<p>&lt; Dynamic viscosity of the central cell</p>
<p>&lt; Dynamic viscosity of the left cell</p>
<p>&lt; Dynamic viscosity of the right cell</p>
<p>&lt; Diffusion coefficient [kg/(m2 s)] of the left face (average)</p>
<p>&lt; Diffusion coefficient [kg/(m2 s)] of the right face (average)</p>
<p>RC correction for the left face velocity</p>
<p>RC correction for the right face velocity</p>
<p>Left face velocity [m/s] (average + RC correction)</p>
<p>Right face velocity [m/s] (average + RC correction)</p>
<p>&lt; Density of the left face (average)</p>
<p>&lt; Density of the right face (average)</p>
<p>&lt; Mass flux [kg/(m2 s)] of the left face</p>
<p>&lt; Mass flux [kg/(m2 s)] of the right face</p>
<p>Diffusion coefficients for the first and last node to define BCs</p>
<p>Velocity BCs: zero velocity on the first node</p>
<p>Velocity BCs: zero velocity on the last node</p>
<p>Inner iterations variables reset</p>
<p>Inner (PISO) iterations. Stop when maximum number of iterations or pressure stops updating.</p>
<p>Tridiagonal coefficients for the pressure correction</p>
<p>Calculates the coefficients for the tridiagonal system of the pressure correction p'</p>
<p>&lt; Density [kg/m3] of the central cell</p>
<p>&lt; Density [kg/m3] of the left cell</p>
<p>&lt; Density [kg/m3] of the right cell</p>
<p>RC correction for the left face velocity</p>
<p>RC correction for the right face velocity</p>
<p>&lt; Density [kg/m3] on the left face</p>
<p>&lt; 1/Ap [(m2 s)/kg] average on left face</p>
<p>&lt; Diffusion coefficient [s/m] on the left face</p>
<p>&lt; Density [kg/m3] on the right face</p>
<p>&lt; 1/Ap [(m2 s)/kg] average on right face</p>
<p>&lt; Diffusion coefficient [s/m] on the right face</p>
<p>&lt; Left face velocity [m/s] (average + RC correction)</p>
<p>&lt; Right face velocity [m/s] (average + RC correction)</p>
<p>&lt; Left face mass flux [kg/(m^2 s)] (upwind discretization)</p>
<p>&lt; Right face mass flux [kg/(m^2 s)] (upwind discretization)</p>
<p>&lt; Mass difference of the fluxes across faces [kg/(m^2 s)]</p>
<p>&lt; Mass flux [kg/(m^2 s)] due to external source (positive if out of the wick)</p>
<p>&lt; [s/m]</p>
<p>&lt; [s/m]</p>
<p>&lt; [s/m]</p>
<p>&lt; [kg/(m^2 s)]</p>
<p>BCs for the correction of pressure: zero gradient at first node</p>
<p>BCs for the correction of pressure: zero at first node</p>
<p>Corrects the pressure with p'</p>
<p>Corrects the velocity with p'</p>
<p>Tridiagonal coefficients for the wick temperature</p>
<p>Calculates the coefficients for the tridiagonal system of the wick temperature T</p>
<p>&lt; Density [kg/m3] of the central cell</p>
<p>&lt; Density [kg/m3]of the left cell</p>
<p>&lt; Density [kg/m3]of the right cell</p>
<p>&lt; Thermal conductivity [W/(m*K)] of the central cell</p>
<p>&lt; Thermal conductivity [W/(m*K)] of the left cell</p>
<p>&lt; Thermal conductivity [W/(m*K)] of the right cell</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the central cell</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the left cell</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the right cell</p>
<p>&lt; Useful constant [W/(m^2 K)]</p>
<p>&lt; Diffusion coefficient [W/(m^2 K)] of the left face (average)</p>
<p>&lt; Diffusion coefficient [W/(m^2 K)] of the right face (average)</p>
<p>RC correction for the left face velocity</p>
<p>RC correction for the right face velocity</p>
<p>Left face velocity [m/s] (average + RC correction)</p>
<p>Right face velocity [m/s] (average + RC correction)</p>
<p>&lt; Density [kg/m3] of the left face (upwind)</p>
<p>&lt; Density [kg/m3] of the right face (upwind)</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the left face (upwind)</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the right face (upwind)</p>
<p>&lt; Mass flux [kg/(m2 s)] of the left face (upwind)</p>
<p>&lt; Mass flux [kg/(m2 s)] of the left face (upwind)</p>
<p>&lt; Mass flux [W/(m^2 K)] of the left face (upwind)</p>
<p>&lt; Mass flux [W/(m^2 K)] of the left face (upwind)</p>
<p>Volumetric heat source due to heat flux at the wall-wick interface [W/m^3]</p>
<p>Volumetric heat source due to heat flux at the wick-vapor interface [W/m^3]</p>
<p>&lt; Wick volumetric heat source [W/m^3]</p>
<p>&lt; [W/(m^2 K)]</p>
<p>&lt; [W/(m^2 K)]</p>
<p>&lt; [W/(m^2 K)]</p>
<p>&lt; [W/m2]</p>
<p>Temperature BCs: zero gradient on the first node</p>
<p>Temperature BCs: zero gradient on the last node</p>
<p>Temperature distribution coefficients (six coefficients per node, two parabolas) First three coefficients are a_w, b_w, c_w Last three coefficients are a_x, b_x, c_x</p>
<p>Calculates the parabolas coefficients for each node</p>
<p>&lt; Linear system matrix A</p>
<p>&lt; Linear system vector B</p>
<p>&lt; Surface fraction of the wick available for phasic interface [-]</p>
<p>&lt; Mass transfer parameter beta [s/m]</p>
<p>&lt; Evaporation accomodation coefficient [-]. 1 means optimal evaporation</p>
<p>&lt; Condensation accomodation coefficient [-]. 1 means optimal condensation</p>
<p>Mass flux from the wick to the vapor [kg/(m2 s)]. Calculated using the kinetic gas theory.</p>
<p>Variable b [-], used to calculate omega. Ratio of the overrall speed to the most probable velocity of the vapor.</p>
<p>Linearization of the omega [-] function to correct the net evaporation/condensation mass flux</p>
<p>&lt; Wall thermal conductivity [W/(m K)]</p>
<p>&lt; Liquid thermal conductivity [W/(m K)]</p>
<p>&lt; Vapor specific heat [J/(kg K)]</p>
<p>&lt; Vapor thermal conductivity [W/(m K)]</p>
<p>&lt; Effective vapor thermal conductivity [W/(m K)]</p>
<p>&lt; Vapor dynamic viscosity [Pa*s]</p>
<p>&lt; Hydraulic diameter of the vapor core [m]</p>
<p>&lt; Reynolds number [-]</p>
<p>&lt; Prandtl number [-]</p>
<p>&lt; Convective heat transfer coefficient at the vapor-wick interface [W/m^2/K]</p>
<p>&lt; Saturation pressure [Pa] <br  />
</p>
<p>&lt; Derivative of the saturation pressure wrt T [Pa/K] <br  />
</p>
<p>&lt; Useful factor in the coefficients calculation [s / m^2]</p>
<p>Variation of the vapor pressure due to density and temperature changes [Pa] Calculating using THROHPUT linearization approach (function of density and temperature)</p>
<p>&lt; Mass volumetric source [kg/(m3 s)] (positive if evaporation)</p>
<p>&lt; b coefficient [kg/(m3 s K)]</p>
<p>&lt; a coefficient [kg/(m3 s)]</p>
<p>&lt; c coefficient [s/m2]</p>
<p>Coefficients for the parabolic temperature profiles in wall and wick (check equations)</p>
<p>&lt; Returns [a_w, b_w, c_w, a_x, b_x, c_x]</p>
<p>&lt; Temperature at the outer wall</p>
<p>&lt; Temperature at the wall wick interface</p>
<p>&lt; Temperature backup</p>
<p>&lt; Temperature at the wick vapor interface</p>
<p>&lt; Evaporator imposed heat flux</p>
<p>&lt; Condenser convective heat flux</p>
<p>&lt; Condenser irradiation heat flux</p>
<p>&lt; Heat flux at the outer wall (positive if to the wall)</p>
<p>Evaluates maximum absolute value of the vapor velocity</p>
<p>Evaluates maximum density value of the vapor</p>
<p>Evaluates minimum temperature value of the vapor</p>
<p>Backup old variables</p>
<p>Wick vapor coupling hypotheses: the pressure in the last cell of the domain is considered the saturation pressure at the temperature of the interface.</p>
<p>Outer iterations variables reset</p>
<p>Inner iterations variables initialization</p>
<p>Outer iterations. Stop when maximum number of iterations or velocity stops updating.</p>
<p>&lt; Density [kg/m3] of the central cell</p>
<p>&lt; Density [kg/m3] of the left cell</p>
<p>&lt; Density [kg/m3] of the right cell</p>
<p>&lt; Dynamic viscosity [kg/(m s)] of the central cell</p>
<p>&lt; Dynamic viscosity [kg/(m s)] of the left cell</p>
<p>&lt; Dynamic viscosity [kg/(m s)] of the right cell</p>
<p>&lt; Diffusion coefficient [kg/(m2 s)] of the left face (average)</p>
<p>&lt; Diffusion coefficient [kg/(m2 s)] of the right face (average)</p>
<p>RC correction for the left face velocity</p>
<p>RC correction for the right face velocity</p>
<p>&lt; Left face velocity [m/s] (average + RC correction)</p>
<p>&lt; Right face velocity [m/s] (average + RC correction)</p>
<p>&lt; Density [kg/m3] of the left face (upwind)</p>
<p>&lt; Density [kg/m3] of the right face (upwind)</p>
<p>&lt; Mass flux [kg/(m2 s)] of the left face (upwind)</p>
<p>&lt; Mass flux [kg/(m2 s)] of the right face (upwind)</p>
<p>&lt; Reynolds number [-]</p>
<p>&lt; Friction factor [-] (according to THROHPUT)</p>
<p>&lt; Friction force [kg / (m3 s)]</p>
<p>Diffusion coefficients for the first and last node to define BCs</p>
<p>Velocity BCs needed variables for the first node</p>
<p>Velocity BCs needed variables for the last node</p>
<p>Velocity BCs: zero velocity on the first node</p>
<p>Velocity BCs: zero velocity on the last node</p>
<p>Inner iterations variables reset</p>
<p>Inner (PISO) iterations. Stop when maximum number of iterations or velocity stops updating.</p>
<p>Tridiagonal coefficients for the pressure correction</p>
<p>Calculates the coefficients for the tridiagonal system of the pressure correction p'</p>
<p>&lt; Density [kg/m3] of the central cell</p>
<p>&lt; Density [kg/m3] of the left cell</p>
<p>&lt; Density [kg/m3] of the right cell</p>
<p>RC correction for the left face velocity</p>
<p>RC correction for the right face velocity</p>
<p>&lt; Density [kg/m3] on the left face</p>
<p>&lt; 1/Ap [(m2 s)/kg] average on left face</p>
<p>&lt; Diffusion coefficient [s/m] on the left face</p>
<p>&lt; Density [kg/m3] on the right face</p>
<p>&lt; 1/Ap [(m2 s)/kg] average on right face</p>
<p>&lt; Diffusion coefficient [s/m] on the right face</p>
<p>&lt; Compressibility [kg/J] assuming ideal gas</p>
<p>&lt; Left face velocity [m/s] (average + RC correction)</p>
<p>&lt; Right face velocity [m/s] (average + RC correction)</p>
<p>&lt; Left face mass flux [kg/(m^2 s)] (upwind discretization)</p>
<p>&lt; Right face mass flux [kg/(m^2 s)] (upwind discretization)</p>
<p>&lt; Mass difference of the fluxes across faces [kg/(m^2 s)]</p>
<p>&lt; Mass flux [kg/(m^2 s)] due to external source (positive if out of the wick)</p>
<p>&lt; [s/m]</p>
<p>&lt; [s/m]</p>
<p>&lt; [s/m]</p>
<p>&lt; [kg/(m^2 s)]</p>
<p>BCs for the correction of pressure: zero gradient at first node</p>
<p>BCs for the correction of pressure: zero at first node</p>
<p>Corrects the pressure with p'</p>
<p>Corrects the velocity with p' and checks the sonic limit</p>
<p>Models the effects of turbulence on thermal conductivity and dynamic viscosity</p>
<p>&lt; Diffusion coefficient for k [-]</p>
<p>&lt; Diffusion coefficient for ω [-]</p>
<p>&lt; Production limiter coefficient [-]</p>
<p>&lt; Dissipation coefficient for ω [-]</p>
<p>&lt; Blending coefficient [-]</p>
<p>Tridiagonal coefficients for k</p>
<p>Tridiagonal coefficients for omega</p>
<p>&lt; Velocity gradient du/dz [1/s]</p>
<p>&lt; Turbulence production rate term [m2/s3]</p>
<p>Compute velocity gradient and turbulence production term</p>
<p>Assemble coefficients for the k-equation (turbulent kinetic energy) in 1D.</p>
<p>k BCs, constant value at the inlet</p>
<p>k BCs, constant value at the outlet</p>
<p>Assemble coefficients for the ω-equation (specific dissipation rate) in 1D.</p>
<p>w BCs, constant value at the inlet</p>
<p>w BCs, constant value at the outlet</p>
<p>Update turbulent viscosity using k/ω and apply limiter.</p>
<p>&lt; Density [kg/m3] of the central cell</p>
<p>&lt; Density [kg/m3] of the left cell</p>
<p>&lt; Density [kg/m3] of the right cell</p>
<p>&lt; Thermal conductivity [W/(m*K)] of the central cell <br  />
</p>
<p>&lt; Thermal conductivity [W/(m*K)] of the left cell</p>
<p>&lt; Thermal conductivity [W/(m*K)] of the right cell</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the central cell</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the left cell</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the right cell</p>
<p>&lt; Useful constant [W/(m^2 K)]</p>
<p>&lt; Effective t. c. [J/(kg K)] of the central cell</p>
<p>&lt; Effective t. c. [J/(kg K)] of the left cell</p>
<p>&lt; Effective t. c. [J/(kg K)] of the right cell</p>
<p>&lt; Diffusion coefficient [W/(m^2 K)] of the left face (average)</p>
<p>&lt; Diffusion coefficient [W/(m^2 K)] of the right face (average)</p>
<p>RC correction for the left face velocity</p>
<p>RC correction for the right face velocity</p>
<p>Left face velocity [m/s] (average + RC correction)</p>
<p>Right face velocity [m/s] (average + RC correction)</p>
<p>&lt; Density [kg/m3] of the left face (upwind)</p>
<p>&lt; Density [kg/m3] of the right face (upwind)</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the left face (upwind)</p>
<p>&lt; S. h. at constant pressure [J/(kg K)] of the right face (upwind)</p>
<p>&lt; Mass flux [kg/(m2 s)] of the left face (upwind) <br  />
</p>
<p>&lt; Mass flux [kg/(m2 s)] of the left face (upwind)</p>
<p>&lt; Mass flux [W/(m^2 K)] of the left face (upwind)</p>
<p>&lt; Mass flux [W/(m^2 K)] of the left face (upwind)</p>
<p>&lt; Wick volumetric heat source [W/m^3]</p>
<p>&lt; [W/(m^2 K)]</p>
<p>&lt; [W/(m^2 K)]</p>
<p>&lt; [W/(m^2 K)]</p>
<p>&lt; [W/m^2]</p>
<p>Temperature BCs: zero gradient on the first node</p>
<p>Temperature BCs: zero gradient on the last node</p>

</div>
</div>
<a id="a8909682f224220a63ed73605d81d23b9" name="a8909682f224220a63ed73605d81d23b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8909682f224220a63ed73605d81d23b9">&#9670;&#160;</a></span>new_dt_v()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double new_dt_v </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt_old</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>rho</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>bVU</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute adaptive time step for the vapor region from CFL, source, and pressure limits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dz</td><td>spatial step size. </td></tr>
    <tr><td class="paramname">dt_old</td><td>previous time step. </td></tr>
    <tr><td class="paramname">u</td><td>velocity field. </td></tr>
    <tr><td class="paramname">T</td><td>temperature field. </td></tr>
    <tr><td class="paramname">rho</td><td>density field. </td></tr>
    <tr><td class="paramname">Sm</td><td>mass source term field. </td></tr>
    <tr><td class="paramname">bVU</td><td>compressibility-related coefficient field. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New time step satisfying acoustic, source, and pressure stability constraints. </dd></dl>
<p>&lt; Vapor sodium gas constant [-]</p>
<p>&lt; Gas constant for the sodium vapor [J/(kg K)]</p>
<p>&lt; Limit coefficients</p>
<p>&lt; This is to prevent divisions by zero (e.g. if the source is zero)</p>
<p>&lt; Adjusting coefficient for the timestep candidate</p>
<p>&lt; Coefficient for damping the timestep correction</p>
<p>&lt; Timestep boundaries [s]</p>

</div>
</div>
<a id="aaa4b5e5c27faabf8d15f4b629847cb5a" name="aaa4b5e5c27faabf8d15f4b629847cb5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa4b5e5c27faabf8d15f4b629847cb5a">&#9670;&#160;</a></span>new_dt_w()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double new_dt_w </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt_old</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>St</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute adaptive time step for the wall region based on Fourier and source limits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dz</td><td>spatial step size. </td></tr>
    <tr><td class="paramname">dt_old</td><td>previous time step. </td></tr>
    <tr><td class="paramname">T</td><td>wall temperature field. </td></tr>
    <tr><td class="paramname">St</td><td>volumetric source term field. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New time step satisfying diffusion and source stability constraints. </dd></dl>
<p>&lt; Limit coefficients</p>
<p>&lt; This is to prevent divisions by zero (e.g. if the source is zero)</p>
<p>&lt; Adjusting coefficient for the timestep candidate</p>
<p>&lt; Coefficient for damping the timestep correction</p>
<p>&lt; Timestep boundaries [s]</p>
<p>Minimum time step due to CFL</p>
<p>Minimum time step due to CS limit</p>

</div>
</div>
<a id="a4baec83d8b53f813e178e216e6bf564e" name="a4baec83d8b53f813e178e216e6bf564e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4baec83d8b53f813e178e216e6bf564e">&#9670;&#160;</a></span>new_dt_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double new_dt_x </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt_old</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>Sm</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute adaptive time step for the wick region based on CFL and source limits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dz</td><td>spatial step size. </td></tr>
    <tr><td class="paramname">dt_old</td><td>previous time step. </td></tr>
    <tr><td class="paramname">u</td><td>wick velocity field. </td></tr>
    <tr><td class="paramname">T</td><td>wick bulk temperature field. </td></tr>
    <tr><td class="paramname">Sm</td><td>wick mass source term field. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New time step satisfying advection and source stability constraints. </dd></dl>
<p>&lt; Limit coefficients</p>
<p>&lt; This is to prevent divisions by zero (e.g. if the source is zero)</p>
<p>&lt; Adjusting coefficient for the timestep candidate</p>
<p>&lt; Coefficient for damping the timestep correction</p>
<p>&lt; Timestep boundaries [s]</p>

</div>
</div>
<a id="a2d93b590ec4558c784a21cc3ed1d965c" name="a2d93b590ec4558c784a21cc3ed1d965c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d93b590ec4558c784a21cc3ed1d965c">&#9670;&#160;</a></span>solve6()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a> solve6 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#aacd8426c8e13284c47795ca7fef1dc2f">Mat6x6</a></td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a></td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solves a 6x6 system of linear equations A*x = b using Gaussian elimination. </p>
<p>This function applies Gaussian elimination with partial pivoting to transform the augmented matrix [A|b] into an upper triangular form. It then solves for the unknown vector 'x' using back substitution. The function works only for 6x6 systems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>The 6x6 coefficient matrix. This matrix is modified in-place (transformed into an upper triangular matrix). </td></tr>
    <tr><td class="paramname">b</td><td>The 6-element right-hand side vector. This vector is also modified in-place to reflect the operations on A. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="#a48fc450adecaed9dfff6df33f2383398">Vec6</a> The solution vector 'x' for the system A*x = b. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>If the matrix A is singular (or near-singular, meaning a pivot element is zero), preventing a unique solution.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This implementation uses <b>partial pivoting</b> to ensure numerical stability by selecting the largest absolute element in the current column below the pivot as the pivot element. </dd></dl>

</div>
</div>
<a id="a8d9a4315511d73aa1771dcc2f526c92e" name="a8d9a4315511d73aa1771dcc2f526c92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9a4315511d73aa1771dcc2f526c92e">&#9670;&#160;</a></span>solveTridiagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; solveTridiagonal </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>d</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves a tridiagonal system of linear equations A*x = d using the Thomas Algorithm (TDMA). </p>
<p>The method consists of two main phases: forward elimination and back substitution, which is optimized for the sparse tridiagonal structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The sub-diagonal vector (size N, with a[0] being zero/unused). </td></tr>
    <tr><td class="paramname">b</td><td>The main diagonal vector (size N). Must contain non-zero elements. </td></tr>
    <tr><td class="paramname">c</td><td>The super-diagonal vector (size N, with c[N-1] being zero/unused). </td></tr>
    <tr><td class="paramname">d</td><td>The right-hand side vector (size N). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::vector&lt;double&gt; The solution vector 'x' (size N).<ul>
<li></li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This implementation assumes the system is diagonally dominant or otherwise stable, as it does not include pivoting. The vectors 'a', 'b', 'c', and 'd' must all have the same size N, corresponding to the size of the system. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="coupling_8cpp.html">coupling.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
